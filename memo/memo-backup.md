JavaScriptã§PNGã®ãƒãƒ£ãƒ³ã‚¯å…±é€šéƒ¨åˆ†ã‚’èª­ã‚€

ã€€PNGã¯ã‚·ã‚°ãƒãƒãƒ£ã‹ã‚‰ã¯ã˜ã¾ã‚Šä»¥é™ã¯ãƒãƒ£ãƒ³ã‚¯ã¨å‘¼ã°ã‚Œã‚‹å®šå½¢ãƒã‚¤ãƒŠãƒªé…åˆ—ã«ãªã£ã¦ã„ã‚‹ã€‚ã“ã®ãƒãƒ£ãƒ³ã‚¯ã‚’èª­ã‚€ã€‚

<!-- more -->

# ãƒ–ãƒ„

* [DEMO][]
* [ãƒªãƒã‚¸ãƒˆãƒª][]

[DEMO]:https://ytyaru.github.io/Html.PNG.Chunk.IHDR.20221202171226
[ãƒªãƒã‚¸ãƒˆãƒª]:https://github.com/ytyaru/Html.PNG.Chunk.IHDR.20221202171226

```sh
NAME='Html.PNG.Chunk.IHDR.20221202171226'
git clone https://github.com/ytyaru/$NAME
cd $NAME/docs
./server.sh
```

1. ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’èµ·å‹•ã™ã‚‹
1. ä¸Šè¨˜ã‚³ãƒãƒ³ãƒ‰ã‚’å©ã
1. èµ·å‹•ã—ãŸãƒ–ãƒ©ã‚¦ã‚¶ã§HTTPSã‚’å®Ÿè¡Œã™ã‚‹ï¼ˆChromiumã®å ´åˆã¯ä»¥ä¸‹ï¼‰
	1. `ã“ã®æ¥ç¶šã§ã¯ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãŒä¿è­·ã•ã‚Œã¾ã›ã‚“`ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
	1. `è©³ç´°è¨­å®š`ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
	1. `localhost ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ï¼ˆå®‰å…¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰`ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹
1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸ã¶ï¼ˆæ¬¡ã®ã†ã¡ã„ãšã‚Œã‹ã®æ–¹æ³•ã§ï¼‰
	* ä»»æ„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹
	* ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã™ã‚‹
1. PNGåˆ¤å®šãŒå®Ÿè¡Œã•ã‚Œã‚‹
	* ã‚‚ã—PNGãªã‚‰`ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯PNGå½¢å¼ã§ã™ğŸ˜„`ã¨è¡¨ç¤ºã•ã‚Œã€PNGç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹
	* ã‚‚ã—PNGã§ãªã„ãªã‚‰`ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯PNGå½¢å¼ã§ãªã„ï¼`ã¨è¡¨ç¤ºã•ã‚Œã‚‹

ã€€ãƒ†ã‚¹ãƒˆç”¨PNGç”»åƒã¯ãƒªãƒã‚¸ãƒˆãƒªã®`./docs/asset/image/monar-mark-gold.png`ã«ã‚ã‚‹ã€‚éPNGãƒ•ã‚¡ã‚¤ãƒ«ã¯é©å½“ã«`README.md`ã‚’ä½¿ãˆã°ã„ã„ã€‚

## å‰å›ã¾ã§

* [Html.Canvas.toDataURL.20221129184336][]
* [Html.PNG.Signature.20221202103208][]
* [Html.PNG.Chunk.IHDR.20221202171226][]

[Html.Canvas.toDataURL.20221129184336]:https://github.com/ytyaru/Html.Canvas.toDataURL.20221129184336
[Html.PNG.Signature.20221202103208]:https://github.com/ytyaru/Html.PNG.Signature.20221202103208
[Html.PNG.Chunk.IHDR.20221202171226]:https://github.com/ytyaru/Html.PNG.Chunk.IHDR.20221202171226

# ç›®æ¨™

* [png-file-chunk-inspector][]

[png-file-chunk-inspector]:https://www.nayuki.io/page/png-file-chunk-inspector

ã€€ä¸Šè¨˜ã®ã‚ˆã†ã«PNGãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒ£ãƒ³ã‚¯ã‚’èª­ã¿ãŸã„ã€‚ä»Šå›ã¯ãƒãƒ£ãƒ³ã‚¯ã®å…±é€šéƒ¨åˆ†ã‚’èª­ã‚€ã€‚

# æ¦‚è¦

ã€€PNGãƒ•ã‚¡ã‚¤ãƒ«ã¯å…ˆé ­ãŒ[ã‚·ã‚°ãƒãƒãƒ£][]ã§ã¯ã˜ã¾ã‚Šã€ä»¥é™ã¯ã™ã¹ã¦[ãƒãƒ£ãƒ³ã‚¯][]ã¨ã‚ˆã°ã‚Œã‚‹å½¢å¼ã®ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã«ãªã‚‹ã€‚

* [ã‚·ã‚°ãƒãƒãƒ£][]
* [ãƒãƒ£ãƒ³ã‚¯][]

[PNGãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚°ãƒãƒãƒ£]:https://www.w3.org/TR/png/#5PNG-file-signature
[ãƒãƒ£ãƒ³ã‚¯ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ]:https://www.w3.org/TR/png/#5Chunk-layout

ã‚µã‚¤ã‚º|ãƒ‡ãƒ¼ã‚¿ç¨®åˆ¥|å€¤ã®ä¾‹
------|----------|------
8|PNGãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚°ãƒãƒãƒ£|`89 50 4E 47 0D 0A 1A 0A`
N|ãƒãƒ£ãƒ³ã‚¯|`...`
N|ãƒãƒ£ãƒ³ã‚¯|`...`
N|ãƒãƒ£ãƒ³ã‚¯|`...`

ã€€ãƒãƒ£ãƒ³ã‚¯ã¯å¿…ãšæ¬¡ã®ã‚ˆã†ãªãƒã‚¤ãƒŠãƒªé…åˆ—ã§ã‚ã‚‹ã€‚

ç¨®é¡|ã‚µã‚¤ã‚º|æ„å‘³
----|------|----
length|4|ã“ã®ãƒãƒ£ãƒ³ã‚¯ã®ãƒ‡ãƒ¼ã‚¿é•·
type|4|ãƒãƒ£ãƒ³ã‚¯ç¨®åˆ¥ï¼ˆASCII4å­—ï¼‰
data|N|ãƒãƒ£ãƒ³ã‚¯ã®ãƒ‡ãƒ¼ã‚¿
[CRC][]|4|ãƒ‡ãƒ¼ã‚¿ç ´æãƒã‚§ãƒƒã‚¯ç”¨ï¼ˆ`type`ã¨`data`ã‹ã‚‰ç®—å‡ºã™ã‚‹ï¼‰

ã€€ãƒãƒ£ãƒ³ã‚¯ã«ã¯ã„ãã¤ã‹ã®ç¨®é¡ãŒã‚ã‚Šã€ãã‚Œãã‚Œ`type`ã«å›ºæœ‰ã®è­˜åˆ¥åãŒASCIIã‚³ãƒ¼ãƒ‰ã§å…¥ã‚‹ã€‚`data`éƒ¨åˆ†ã¯å¯å¤‰ã§ã‚ã‚Šã€ã“ã“ã«ãã®ãƒãƒ£ãƒ³ã‚¯å›ºæœ‰ã®ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã‚‹ã€‚å„ãƒãƒ£ãƒ³ã‚¯ã«ã¤ã„ã¦ã¯[ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§][]ã‚’å‚ç…§ã€‚

[ãƒãƒ£ãƒ³ã‚¯ä¸€è¦§]:https://www.w3.org/TR/png/#4Concepts.FormatTypes
[CRC]:https://ja.wikipedia.org/wiki/%E5%B7%A1%E5%9B%9E%E5%86%97%E9%95%B7%E6%A4%9C%E6%9F%BB

ã€€ã“ã®ã†ã¡å¿…é ˆãƒãƒ£ãƒ³ã‚¯ã¯`IHDR`,`IDAT`,`IEND`ã€‚ã¤ã¾ã‚ŠPNGãƒ•ã‚¡ã‚¤ãƒ«ã¯æ¬¡ã®ã‚ˆã†ãªé †ã®ãƒã‚¤ãƒŠãƒªé…åˆ—ã¨ãªã‚‹ã€‚

byte|ãƒ‡ãƒ¼ã‚¿
----|------
8|ã‚·ã‚°ãƒãƒãƒ£
25|`IHDR`
N|`IDAT`
12|`IEND`

## `IHDR`

ç¨®é¡|ã‚µã‚¤ã‚º|å€¤
----|------|---
length|4|`13`
type|4|`49 48 44 52`
width|4|`1`ã€œ
height|4|`1`ã€œ
bitDepth|1|`1`,`2`,`4`,`8`,`16`
colorType|1|`0`,`2`,`3`,`4`,`6`
compressionMethod|1|`0`
filterMethod|1|`0`
interlaceMethod|1|`0`,`1`
[CRC][]|4|ãƒã‚§ãƒƒã‚¯ã‚µãƒ è¨ˆç®—å€¤

ã€€`colorType`ã¨`bitDepth`ã®å¯¾å¿œè¡¨ã¯ä»¥ä¸‹ã€‚

`colorType`|`bitDepth`|æ„å‘³
-----------|----------|----
`0`|`1`,`2`,`4`,`8`,`16`|ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«
`2`|`8`,`16`|ãƒˆã‚¥ãƒ«ãƒ¼ã‚«ãƒ©ãƒ¼
`3`|`1`,`2`,`4`,`8`|ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚«ãƒ©ãƒ¼
`4`|`8`,`16`|ã‚°ãƒ¬ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ï¼‹Î±ãƒãƒ£ãƒ³ãƒãƒ«
`6`|`8`,`16`|ãƒˆã‚¥ãƒ«ãƒ¼ã‚«ãƒ©ãƒ¼ï¼‹Î±ãƒãƒ£ãƒ³ãƒãƒ«

## `IDAT`

ç¨®é¡|ã‚µã‚¤ã‚º|å€¤
----|------|--
length|4|`0`
type|4|`49 45 4E 44`
data|N|`FF`...
[CRC][]|4|è¨ˆç®—å€¤

## `IEND`

ç¨®é¡|ã‚µã‚¤ã‚º|å€¤
----|------|--
length|4|`0`
type|4|`49 45 4E 44`
[CRC][]|4|è¨ˆç®—å€¤

# `IHDR`ã‚’èª­ã‚€

ã€€`IHDR`ã¯ã‚·ã‚°ãƒãƒãƒ£ã®ç›´å¾Œã«æ¥ã‚‹ã€‚ã‚µã‚¤ã‚ºã¯25ãƒã‚¤ãƒˆå›ºå®šã€‚ã¤ã¾ã‚Šå…ˆé ­ã‹ã‚‰`8`ã€œ`33`ãƒã‚¤ãƒˆã®ç¯„å›²ã«ã‚ã‚‹ã€‚

1. å…ˆé ­8ãƒã‚¤ãƒˆã®ã‚·ã‚°ãƒãƒãƒ£ã‚’èª­ã‚“ã§PNGã§ã‚ã‚‹ã¨åˆ¤å®šã—ãŸãªã‚‰
1. `IHDR`ãƒãƒ£ãƒ³ã‚¯ã‚’èª­ã‚€

ã€€`IHDR`ã‚’èª­ã‚€ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã€‚`show()`ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ã€`toHtml()`ã§HTMLãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆã™ã‚‹ã€‚

```javascript
const ihdr = new IHDR(new DataView(await file.arrayBuffer()))
ihdr.show()
ihdr.toHtml()
```

ã€€`IHDR`ã‚¯ãƒ©ã‚¹ã®å®Ÿè£…ã¯ä»¥ä¸‹ã€‚`constructor()`ã§PNGç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®[DataView][]ã‚’å—ã‘å–ã‚Šã€è§£æã—ã¦ã€ã‚­ãƒ£ã‚¹ãƒˆã—ã€ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å¤‰æ•°ã«ã‚»ãƒƒãƒˆã—ã¦ã„ã‚‹ã€‚

```javascript
export class IHDR {
    KEYS = ['length', 'type', 'width', 'height', 'bitDepth', 'colorType', 'compressionMethod', 'filterMethod', 'interlaceMethod', 'crc']
    constructor(dataView) {
        const SIG_SZ = 8
        this.length = dataView.getUint32(SIG_SZ)
        this.type = new TextDecoder('ascii').decode(new Uint8Array([
            dataView.getUint8(SIG_SZ + 4),
            dataView.getUint8(SIG_SZ + 5),
            dataView.getUint8(SIG_SZ + 6),
            dataView.getUint8(SIG_SZ + 7),
        ]))
        this.width = dataView.getUint32(SIG_SZ + 8)
        this.height = dataView.getUint32(SIG_SZ + 12)
        this.bitDepth = dataView.getUint8(SIG_SZ + 16)
        this.colorType = dataView.getUint8(SIG_SZ + 17)
        this.compressionMethod = dataView.getUint8(SIG_SZ + 18)
        this.filterMethod = dataView.getUint8(SIG_SZ + 19)
        this.interlaceMethod = dataView.getUint8(SIG_SZ + 20)
        this.crc = dataView.getUint32(SIG_SZ + 21)
    }
    show() {
        for (const prop of this.KEYS) { console.log(`${prop}: ${Reflect.get(this, prop)}`) }
    }
    toHtml() {
        const table = document.createElement('table')
        const caption = document.createElement('caption')
        caption.textContent = this.type
        table.appendChild(caption)
        for (const prop of this.KEYS) {
            const tr = document.createElement('tr')
            const th = document.createElement('th')
            const td = document.createElement('td')
            th.textContent = prop
            td.textContent = Reflect.get(this, prop)
            tr.appendChild(th)
            tr.appendChild(td)
            table.appendChild(tr)
        }
        return table
    }
}
```

ã€€`IHDR`ãƒãƒ£ãƒ³ã‚¯ã¯ã‚·ã‚°ãƒãƒãƒ£ã®ç›´å¾Œã«ãã‚‹ãŸã‚å…ˆé ­ã‹ã‚‰ã®ãƒã‚¤ãƒˆä½ç½®ãŒå›ºå®šã§ã‚ã‚‹ã€‚ãªã®ã§ä¸€ç•ªã‚«ãƒ³ã‚¿ãƒ³ã«å–å¾—ã§ãã‚‹ãƒãƒ£ãƒ³ã‚¯ã€‚

offset|length|16é€²æ•°ãƒã‚¤ãƒŠãƒª|æ„å‘³
------|------|--------------|----
0|8|`89 50 4E 47 0D 0A 1A 0A`|ã‚·ã‚°ãƒãƒãƒ£
9|4|`00 00 00 13`|`IHDR.length`
13|4|`49 48 44 52`|`IHDR.type`
17|4|`00 00 00 00`|`IHDR.width`
21|4|`00 00 00 00`|`IHDR.height`
25|1|`00`|`IHDR.bitDepth`
26|1|`00`|`IHDR.colorType`
27|1|`00`|`IHDR.compressionMethod`
28|1|`00`|`IHDR.filterMethod`
29|1|`00`|`IHDR.interlaceMethod`
30|4|`00 00 00 00`|`IHDR.crc`

ã€€ãŸã¨ãˆã°æœ€åˆã®`IHDR.length`è§£æã«ã¤ã„ã¦ã€‚ã“ã‚Œã¯PNGãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­ã«ãã‚‹ã‚·ã‚°ãƒãƒãƒ£`89 50 4E 47 0D 0A 1A 0A`ï¼ˆ8ãƒã‚¤ãƒˆï¼‰ã®ç›´å¾Œã«ã¤ã¥ãã€æœ€åˆã®ãƒãƒ£ãƒ³ã‚¯`IHDR`ã®æœ€åˆã®ãƒ‡ãƒ¼ã‚¿ã§ã‚ã‚‹ã€‚ãªã®ã§ä½ç½®ã¯å…ˆé ­ã‹ã‚‰8ãƒã‚¤ãƒˆç›®ã«ã‚ã‚‹ã€‚ãã—ã¦`length`ã®ãƒ‡ãƒ¼ã‚¿ã¯4ãƒã‚¤ãƒˆUInt32å‹ã§ã‚ã‚‹ã€‚ã¤ã¾ã‚Šå…ˆé ­ã‹ã‚‰8ãƒã‚¤ãƒˆç›®ã«ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’4ãƒã‚¤ãƒˆå¹…ã®UInit32å‹ã§å–å¾—ã™ã‚Œã°ã„ã„ã€‚

ã€€[DataView][]ã®å„å–å¾—APIã¯`getå‹å(ã‚ªãƒ•ã‚»ãƒƒãƒˆ)`ã¨ãªã£ã¦ã„ã‚‹ã€‚ã‚ªãƒ•ã‚»ãƒƒãƒˆã«ã¯å…ˆé ­ã‹ã‚‰èª­ã¿é£›ã°ã™ãƒã‚¤ãƒˆæ•°ã‚’æŒ‡å®šã™ã‚‹ã€‚ã‚ˆã£ã¦`IHDR.length`ã‚’å–å¾—ã™ã‚‹ã«ã¯å…ˆé ­ã‹ã‚‰8ãƒã‚¤ãƒˆèª­ã¿é£›ã°ã—ãŸUInit32å‹ã€‚ã¨ã—ã¦å–å¾—ã™ã‚Œã°ã„ã„ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã€‚

```javascript
const SIG_SZ = 8
this.length = dataView.getUint32(SIG_SZ)
```

ã€€æ¬¡ã«`IHDR.type`ã‚’èª­ã‚€ã€‚ã“ã‚Œã¯`IHDR`2ç•ªç›®ã§ã‚ã‚Š`length`ã‚„`crc`åŒæ§˜ã€å…¨ãƒãƒ£ãƒ³ã‚¯å…±é€šã§ã‚ã‚‹ã€‚4æ–‡å­—æ–‡ã®ASCIIæ–‡å­—ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã‚‹ã€‚ãƒã‚¤ãƒ³ãƒˆã¯[TextDecoder][]ã‚’ä½¿ã£ã¦ãƒã‚¤ãƒŠãƒªã‹ã‚‰æ–‡å­—åˆ—å‹ã«å¤‰æ›ã—ã¦ã„ã‚‹ã“ã¨ã€‚

[TextDecoder]:https://developer.mozilla.org/ja/docs/Web/API/TextDecoder

ã€€[TextDecoder][]ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã¨ãã¯[TypedArray][]å‹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ASCIIæ–‡å­—ã¯1å­—ã‚ãŸã‚ŠUInit8å‹ã§ã‚ã‚Šã€ã“ã‚ŒãŒ4æ–‡å­—æ–‡ã‚ã‚‹ã®ã§ã€`Uint8Array([A,B,C,D])`ã®ã‚ˆã†ã«ãªã‚‹ã€‚å¼•æ•°ã®é…åˆ—è¦ç´ å€¤ã¯ãã‚Œãã‚Œ1å­—åˆ†ãƒ‡ãƒ¼ã‚¿UInt8ãŒå…¥ã‚‹ã€‚

```javascript
this.type = new TextDecoder('ascii').decode(new Uint8Array([
    dataView.getUint8(SIG_SZ + 4),
    dataView.getUint8(SIG_SZ + 5),
    dataView.getUint8(SIG_SZ + 6),
    dataView.getUint8(SIG_SZ + 7),
]))
```

ã€€ã‚ã¨ã¯å‹ã¨ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚’ä»•æ§˜ã©ãŠã‚Šã«ã—ãªãŒã‚‰å„ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’èª­ã¿å–ã‚Œã°ã„ã„ã ã‘ã€‚

ã€€`show()`ã‚„`toHtml()`ã§ã¯[Reflect][]ã‚’ä½¿ã£ã¦ã„ã‚‹ã€‚ã“ã‚Œã¯æŒ‡å®šã‚¯ãƒ©ã‚¹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ–‡å­—åˆ—ã‹ã‚‰å‚ç…§ã™ã‚‹ã‚‚ã®ã€‚ã‚³ãƒ¼ãƒ‰ã‚’DRYã«æ›¸ããŸã‹ã£ãŸã®ã§ä½¿ã£ãŸã€‚

[Reflect]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Reflect

































type|4|`49 48 44 52`
width|4|`1`ã€œ
height|4|`1`ã€œ
bit_depth|1|`1`,`2`,`4`,`8`,`16`
color_type|1|`0`,`2`,`3`,`4`,`6`
compression_method|1|`0`
filter_method|1|`0`
interlace_method|1|`0`,`1`
[CRC][]|4|ãƒã‚§ãƒƒã‚¯ã‚µãƒ è¨ˆç®—å€¤


ã€€ãƒã‚¤ãƒŠãƒªã¯[DataView][]ã§èª­ã‚€ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿ã¯`drop`ã‚¤ãƒ™ãƒ³ãƒˆã‚„`input type="file"`ã§å–å¾—ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«`files[0]`ï¼ˆ`file`ï¼‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒã‚‚ã¤`arrayBuffer()`ã§å–å¾—ã™ã‚‹ã€‚

```javascript
fileInput.addEventListener('change', async(e)=>{
    await previewFile(e.target.files[0]);
});
```
```javascript
dropZone.addEventListener('drop', async(e)=>{
    var files = e.dataTransfer.files;
    if (files.length > 1) { return alert('é–‹ã‘ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã¯1ã¤ã ã‘ã§ã™ã€‚'); }
    fileInput.files = files;
    await previewFile(files[0]);
})
```


[Drag and Drop API]:https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop
[input type="file" è¦ç´ ]:https://developer.mozilla.org/ja/docs/Web/HTML/Element/input/file
[File]:https://developer.mozilla.org/ja/docs/Web/API/File
[Blob]:https://developer.mozilla.org/ja/docs/Web/API/Blob
[arrayBuffer()]:https://developer.mozilla.org/ja/docs/Web/API/Blob/arrayBuffer

[JavaScript ã®å‹ä»˜ãé…åˆ—]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Typed_arrays
[TypedArray]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Typed_arrays
[ArrayBuffer]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer
[DataView]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/DataView
[Int8Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Int8Array
[Uint8Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array
[Uint8ClampedArray]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Uint8ClampedArray
[Int16Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Int16Array
[Uint16Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Uint16Array
[Int32Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Int32Array
[Uint32Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Uint32Array
[Float32Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Float32Array
[Float64Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Float64Array
[BigInt64Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/BigInt64Array
[BigUint64Array]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/BigUint64Array

[scriptè¦ç´ ]:https://developer.mozilla.org/ja/docs/Web/HTML/Element/script


[ç­‰ä¾¡æ€§ã®æ¯”è¼ƒã¨åŒä¸€æ€§]:https://developer.mozilla.org/ja/docs/Web/JavaScript/Equality_comparisons_and_sameness

